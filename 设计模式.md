# 面向对象的设计原则

## 单一职责原则

**一个类只负责一个功能领域中的相应职责。引起一个类个改变的与原因只有一个**



# 工厂模式


工厂模式是为了将对象的**创建和使用进行分离** ，使用者不需要关注对象的创建和初始化的细节，只需要关注如何使用该对象。

下面以创建日志库为例，需要为用户提供两种日志服务：DatabaseLogger 和 FileLogger。数据库日志服务使用前需要初始化数据库连接，文件日志服务需要初始化文件的创建。

## 简单工厂模式

将 DatabaseLogger 和 FileLogger 抽象成两个类，公共部分抽象成一个接口。然后提供一个工厂类负责对象的创建和初始化。


![输入图片说明](https://raw.githubusercontent.com/GTianLuo/-/master/imgs/30CkAqjt2cXB3z87.png)

**优点**

1. 将对象的创建和使用进行职责分离，用户只需要使用，降低了代码耦合度。当创建或者使用逻辑更改时，只需要改动部分代码。
2. 可以通过引入配置文件的方式，在不更改用户代码的情况下，更换使用的日志库。


**缺点**

1. 当一工厂集中了所有日志库的创建逻辑，职责过重。
2. 不易于扩展，当增加其他日志库时，需要更改Factory中的逻辑代码。



## 工厂方法模式

简单工厂模式只提供了一个工厂类，这个工厂类负责每一个产品对象的创建，耦合度很高。

工厂方法模式就是将原先单一工厂的if-else逻辑使用多态替换掉（对原先单一的工厂进行抽象和拆分）。首先抽象出一个工厂接口来声明抽象工厂方法，由其子类具体实现工厂方法，创建具体的产品对象。

![输入图片说明](https://raw.githubusercontent.com/GTianLuo/-/master/imgs/fnqceslyKstx3PLs.png)

**代码实现**

```go
type LoggerFactory interface {  
   CreateLogger() *logger.Logger  
}  
  
type DatabaseLoggerFactory struct {  
}  
  
func (d *DatabaseLoggerFactory) CreateLogger() logger.Logger {  
   fmt.Println(" init databases connection")  
   return &logger.DatabaseLogger{}  
}  
  
type FileLoggerFactory struct {  
}  
  
func (f *FileLoggerFactory) CreateLogger() logger.Logger {  
   // 初始化环境配置  
   fmt.Println("init file")  
   // 创建对象  
   return &logger.FileLogger{}  
}



// 客户端使用
func main() {  
   f := &loggerFactory.FileLoggerFactory{}  
   logger := f.CreateLogger()  
   logger.WriteLog("hello")  
}
```


**优点**

1. 在系统中增加新的产品时无需更改用户代码和原先的工厂代码，只需要增加一个新的实现了工厂接口的工厂类。扩展线非常好，符合开闭原则。


**缺点**

1. 每增加一个产品类，都需要新增一个工厂类，增加了系统复杂性。



## 抽象工厂模式


为了解决每增加一个产品类。就需要编写新的具体工厂类的问题，我们需要使用抽象工厂模式。**将产品进行了抽象分组。**

不但**工厂是抽象的，产品也是是抽象的**。我们**将产品抽象为不同的组**，一组产品一个工厂，一组内产品对应同组内不同的工厂。

这样原先一个工厂只能生产一个产品类，抽象工厂模式一个工厂可以生产一组同类型的产品。



**特点**

在开闭原则上作出了一定的倾斜性，在增加一个新的产品组时符合开闭原则，但是增加已有组的新产品时需要修改代码。



# 原型模式

使用原型对象，创建一个重复的对象。说简单点就是将原型对象克隆一份。这里又会分浅克隆和深克隆。

**浅克隆**

只会将原型对象的值类型成员变量复制一份给克隆对象，指针类型的成员变量会复制地址给克隆对象。


**深拷贝**
就算遇到指针类型，也要将指针指向的内容拷贝一份。


**使用场景**
1. 新对象要复用原型对象的一些成员变量，比如说C语言Fork子进程，要复用父进程的变量。
2. 



<!--stackedit_data:
eyJoaXN0b3J5IjpbMTcwNDI1MTQwMiwxMTEzMzA1MzUwLC0xND
I2MTUxMjIzLC02NjY2MTAzMzhdfQ==
-->